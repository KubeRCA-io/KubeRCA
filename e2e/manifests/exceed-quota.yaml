# R16 trigger: ExceedQuota
# Creates a tight ResourceQuota then a Pod that exceeds it, producing
# a FailedCreate event with "exceeded quota" in the message.
apiVersion: v1
kind: ResourceQuota
metadata:
  name: tight-quota
  namespace: kuberca-e2e
  labels:
    e2e-test: "true"
    rule: r16
spec:
  hard:
    requests.cpu: "100m"
    requests.memory: "64Mi"
    limits.cpu: "100m"
    limits.memory: "64Mi"
---
# A Deployment that requests more than the quota allows.
apiVersion: apps/v1
kind: Deployment
metadata:
  name: exceed-quota-deploy
  namespace: kuberca-e2e
  labels:
    e2e-test: "true"
    rule: r16
spec:
  replicas: 1
  selector:
    matchLabels:
      app: exceed-quota
  template:
    metadata:
      labels:
        app: exceed-quota
    spec:
      containers:
        - name: app
          image: busybox:1.36
          command: ["sleep", "3600"]
          resources:
            requests:
              cpu: "500m"
              memory: "512Mi"
            limits:
              cpu: "500m"
              memory: "512Mi"
